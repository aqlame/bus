<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Subscribers contexts</title>

    <script src="../bower_components/underscore/underscore.js"></script>
    <script src="../bus.js"></script>
</head>
<body>
<h1>Subscribers contexts</h1>
Subscribers can be added to a context to be unregistered at once: <br>
<ul id="messages"></ul>
<script>
    <!--
    var context1=bus.createContext();
    var subscriber1=bus.register('mymessage1', function (id, message) {
        var link = document.createElement('li');
        link.appendChild(document.createTextNode('Subscriber 1:' + message));
        document.getElementById("messages").appendChild(link)
    }, context1);
    var subscriber2=bus.register('mymessage2', function (id, message) {
        var link = document.createElement('li');
        link.appendChild(document.createTextNode('Subscriber 2:' + message));
        document.getElementById("messages").appendChild(link)
    }, context1);
    bus.send('mymessage1', 'message 1');
    bus.send('mymessage1', 'message 2');
    bus.send('mymessage2', 'message A');
    bus.send('mymessage2', 'message B');

    context1.release();
    _.defer(function(){ // unRegister action is deferred
        bus.send('mymessage1', 'message 3');    // No one will receive this message
        bus.send('mymessage1', 'message 4');    // No one will receive this message
        bus.send('mymessage2', 'message C');    // No one will receive this message
        bus.send('mymessage2', 'message D');    // No one will receive this message

    });
    //-->
</script>
</body>
</html>